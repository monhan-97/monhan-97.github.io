"use strict";(self.webpackChunkhuangmh_blog=self.webpackChunkhuangmh_blog||[]).push([[2181],{1571:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"learn-react-source/setup","title":"\u9879\u76ee\u6846\u67b6\u642d\u5efa","description":"- \u9009\u62e9\u9879\u76ee\u7ed3\u6784(Mono-repo)","source":"@site/docs/learn-react-source/setup.mdx","sourceDirName":"learn-react-source","slug":"/learn-react-source/setup","permalink":"/docs/learn-react-source/setup","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":"monhan-97","lastUpdatedAt":1734272504000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u624b\u5199 React \u6e90\u7801","permalink":"/docs/setup"},"next":{"title":"\u5b9e\u73b0 JSX","permalink":"/docs/learn-react-source/jsx"}}');var i=r(5105),t=r(3881);const l={},o="\u9879\u76ee\u6846\u67b6\u642d\u5efa",c={},a=[{value:"\u9009\u62e9\u9879\u76ee\u7ed3\u6784",id:"\u9009\u62e9\u9879\u76ee\u7ed3\u6784",level:2},{value:"Multi-repo",id:"multi-repo",level:3},{value:"Mono-repo",id:"mono-repo",level:3},{value:"\u9009\u62e9 <code>Mono-repo</code> \u5de5\u5177",id:"\u9009\u62e9-mono-repo-\u5de5\u5177",level:2},{value:"\u5b89\u88c5 yarn",id:"\u5b89\u88c5-yarn",level:3},{value:"\u521d\u59cb\u5316 yarn",id:"\u521d\u59cb\u5316-yarn",level:3},{value:"\u6dfb\u52a0 workspace \u914d\u7f6e",id:"\u6dfb\u52a0-workspace-\u914d\u7f6e",level:3},{value:"\u914d\u7f6e .gitignore",id:"\u914d\u7f6e-gitignore",level:2},{value:"\u914d\u7f6e ESLint",id:"\u914d\u7f6e-eslint",level:2},{value:"\u5b89\u88c5 eslint",id:"\u5b89\u88c5-eslint",level:3},{value:"\u65b0\u589e eslint \u914d\u7f6e",id:"\u65b0\u589e-eslint-\u914d\u7f6e",level:3},{value:"\u914d\u7f6e Prettier",id:"\u914d\u7f6e-prettier",level:2},{value:"\u5b89\u88c5 prettier",id:"\u5b89\u88c5-prettier",level:3},{value:"\u65b0\u589e .prettierrc",id:"\u65b0\u589e-prettierrc",level:3},{value:"\u914d\u7f6e typescript",id:"\u914d\u7f6e-typescript",level:2},{value:"\u5b89\u88c5 typescript",id:"\u5b89\u88c5-typescript",level:3},{value:"\u65b0\u589e tsconfig.json",id:"\u65b0\u589e-tsconfigjson",level:3},{value:"\u9009\u62e9\u6253\u5305\u5de5\u5177(rollup)",id:"\u9009\u62e9\u6253\u5305\u5de5\u5177rollup",level:2},{value:"\u5b89\u88c5 rollup",id:"\u5b89\u88c5-rollup",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u9879\u76ee\u6846\u67b6\u642d\u5efa",children:"\u9879\u76ee\u6846\u67b6\u642d\u5efa"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u9009\u62e9\u9879\u76ee\u7ed3\u6784",(0,i.jsx)(n.code,{children:"(Mono-repo)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5b9a\u4e49\u5f00\u53d1\u89c4\u8303",(0,i.jsx)(n.code,{children:"(eslint\u3001tsc\u3001prettier)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u9009\u62e9\u6253\u5305\u5de5\u5177",(0,i.jsx)(n.code,{children:"(rollup)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u76f8\u5173\u4ee3\u7801\u53ef\u5728 ",(0,i.jsx)(n.a,{href:"https://github.com/monhan-97/react/tree/1.0",children:"git tag v1.0"})," \u67e5\u770b"]}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"\u9009\u62e9\u9879\u76ee\u7ed3\u6784",children:"\u9009\u62e9\u9879\u76ee\u7ed3\u6784"}),"\n",(0,i.jsx)(n.h3,{id:"multi-repo",children:"Multi-repo"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a\u670d\u52a1\u548c\u9879\u76ee\u90fd\u6709\u4e00\u4e2a\u5355\u72ec\u7684\u5b58\u50a8\u5e93"}),"\n",(0,i.jsx)(n.li,{children:"\u56e2\u961f\u53ef\u4ee5\u81ea\u4e3b\u5de5\u4f5c; \u4e2a\u4eba\u7684\u53d8\u66f4\u4e0d\u4f1a\u5f71\u54cd\u5176\u4ed6\u56e2\u961f\u6216\u9879\u76ee\u7684\u53d8\u66f4"}),"\n",(0,i.jsx)(n.li,{children:"\u7ba1\u7406\u5458\u53ef\u4ee5\u5c06\u8bbf\u95ee\u63a7\u5236\u9650\u5236\u5230\u5f00\u53d1\u4eba\u5458\u9700\u8981\u8bbf\u95ee\u7684\u9879\u76ee\u6216\u670d\u52a1"}),"\n",(0,i.jsx)(n.li,{children:"\u826f\u597d\u7684\u6027\u80fd\uff0c\u56e0\u4e3a\u6709\u9650\u7684\u4ee3\u7801\u548c\u8f83\u5c0f\u7684\u670d\u52a1\u5355\u5143"}),"\n",(0,i.jsxs)(n.li,{children:["\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5b9e\u73b0 ",(0,i.jsx)(n.code,{children:"CD"})," \u548c ",(0,i.jsx)(n.code,{children:"CI"}),",\u56e0\u4e3a\u4ed6\u4eec\u53ef\u4ee5\u72ec\u7acb\u5730\u6784\u5efa\u670d\u52a1"]}),"\n",(0,i.jsx)(n.li,{children:"\u5bf9\u5e93\u548c\u5176\u4ed6\u5e38\u89c1\u4ee3\u7801\u7684\u4efb\u4f55\u66f4\u6539\u90fd\u5e94\u8be5\u5b9a\u671f\u540c\u6b65\uff0c\u4ee5\u907f\u514d\u4ee5\u540e\u51fa\u73b0\u95ee\u9898"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"mono-repo",children:"Mono-repo"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4e00\u4e2a\u7ec4\u7ec7\u7684\u6240\u6709\u9879\u76ee\u4ee3\u7801\u90fd\u4f7f\u7528\u4e00\u4e2a\u4e2d\u592e\u5b58\u50a8\u4ed3\u5e93\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u56e2\u961f\u53ef\u4ee5\u4e00\u8d77\u534f\u4f5c\u548c\u5de5\u4f5c,\u53ef\u4ee5\u770b\u5230\u5f7c\u6b64\u7684\u53d8\u5316\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a\u4eba\u90fd\u53ef\u4ee5\u8bbf\u95ee\u6574\u4e2a\u9879\u76ee\u7ed3\u6784"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u9879\u76ee\u89c4\u6a21\u4e0d\u65ad\u589e\u957f,\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5e76\u53d1\u5927\u95ee\u9898\u3002"}),"\n",(0,i.jsxs)(n.li,{children:["\u96be\u4ee5\u5b9e\u73b0",(0,i.jsx)(n.code,{children:"\u6301\u7eed\u90e8\u7f72(CD)"}),"\u548c",(0,i.jsx)(n.code,{children:"\u6301\u7eed\u96c6\u6210(CI)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u8f7b\u677e\u5730",(0,i.jsx)(n.code,{children:"\u5171\u4eab\u5e93"}),"\u3001 \u548c\u5176\u4ed6\u5728\u4e2d\u592e\u5b58\u50a8\u5e93\u4e2d\u66f4\u65b0\u7684\u516c\u5171\u4ee3\u7801"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5f88\u591a\u5927\u578b\u9879\u76ee\u90fd\u662f\u7528 ",(0,i.jsx)(n.code,{children:"Mono-repo"})," \u7ed3\u6784\u7ba1\u7406,\u6bd4\u5982 ",(0,i.jsx)(n.code,{children:"Vue"}),",",(0,i.jsx)(n.code,{children:"Bable"}),",\u6211\u4eec\u4e5f\u9009\u62e9 ",(0,i.jsx)(n.code,{children:"Mono-repo"}),"\u642d\u5efa\u9879\u76ee"]}),"\n",(0,i.jsxs)(n.h2,{id:"\u9009\u62e9-mono-repo-\u5de5\u5177",children:["\u9009\u62e9 ",(0,i.jsx)(n.code,{children:"Mono-repo"})," \u5de5\u5177"]}),"\n",(0,i.jsx)(n.h3,{id:"\u5b89\u88c5-yarn",children:"\u5b89\u88c5 yarn"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install yarn -g\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u521d\u59cb\u5316-yarn",children:"\u521d\u59cb\u5316 yarn"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn init -y\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u6dfb\u52a0-workspace-\u914d\u7f6e",children:"\u6dfb\u52a0 workspace \u914d\u7f6e"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u6839\u76ee\u5f55\u7684 ",(0,i.jsx)(n.code,{children:"package.json"})," \u4e2d\u65b0\u589e ",(0,i.jsx)(n.code,{children:"workspace"})," \u548c ",(0,i.jsx)(n.code,{children:"private"})," \u5c5e\u6027 \u5982\u4e0b:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:"title='package.json'",children:'{\n  "private": true,\n  "workspaces": ["packages/*"],\n  "type": "module",\n  "scripts": { "test": \'echo "Error: no test specified" && exit 1\' },\n  "author": "",\n  "license": "MIT",\n  "packageManager": "yarn@1.22.22",\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"package.json"}),"\u6587\u4ef6\u5b9a\u4e49\u4e86\u5de5\u4f5c\u7a7a\u95f4\u7684\u6839\u76ee\u5f55\u3002\u4e5f\u5c31\u662f\u8bf4, ",(0,i.jsx)(n.code,{children:"packages"})," \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5c31\u662f ",(0,i.jsx)(n.code,{children:"Mono-repo"})," \u7684\u5b50\u9879\u76ee\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u914d\u7f6e-gitignore",children:"\u914d\u7f6e .gitignore"}),"\n",(0,i.jsxs)(n.p,{children:["\u65b0\u589e ",(0,i.jsx)(n.code,{children:".gitignore"})," \u6587\u4ef6\uff0c\u5ffd\u7565\u4ee5\u4e0b\u7684\u6587\u4ef6\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"title='.gitignore'",children:".idea/\n.vscode/\nnode*modules/\nbuild\n*.tgz\nmy-app\\_\ntemplate/src/**tests**/**snapshots**/\nlerna-debug.log\nnpm-debug.log*\nyarn-debug.log*\nyarn-error.log\\*\n/.changelog\n.npm/\n\n.Ds_Store\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u914d\u7f6e-eslint",children:"\u914d\u7f6e ESLint"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"eslint"})," \u4ee3\u7801\u89c4\u8303\u68c0\u67e5"]}),"\n",(0,i.jsx)(n.h3,{id:"\u5b89\u88c5-eslint",children:"\u5b89\u88c5 eslint"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn  add eslint globals eslint-plugin-import-x  typescript-eslint -D -W\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u65b0\u589e-eslint-\u914d\u7f6e",children:"\u65b0\u589e eslint \u914d\u7f6e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:"title='.eslint.config.js'",children:'import { builtinModules } from "node:module";\n\nimport globals from "globals";\nimport importX from "eslint-plugin-import-x";\nimport tseslint from "typescript-eslint";\nimport eslint from "@eslint/js";\n\nconst DOMGlobals = ["window", "document"];\nconst NodeGlobals = ["module", "require"];\n\nconst banConstEnum = {\n  selector: "TSEnumDeclaration[const=true]",\n  message:\n    "Please use non-const enums. This project automatically inlines enums.",\n};\n\nexport default tseslint.config(\n  eslint.configs.recommended,\n  {\n    files: ["**/*.js", "**/*.ts", "**/*.tsx"],\n    extends: [tseslint.configs.base],\n    plugins: {\n      "import-x": importX,\n    },\n    rules: {\n      "no-debugger": "error",\n\n      "no-console": ["error", { allow: ["warn", "error", "info"] }],\n      // most of the codebase are expected to be env agnostic\n      "no-restricted-globals": ["error", ...DOMGlobals, ...NodeGlobals],\n\n      "no-restricted-syntax": [\n        "error",\n        banConstEnum,\n        {\n          selector: "ObjectPattern > RestElement",\n          message:\n            "Our output target is ES2016, and object rest spread results in " +\n            "verbose helpers and should be avoided.",\n        },\n        {\n          selector: "ObjectExpression > SpreadElement",\n          message:\n            "esbuild transpiles object spread into very verbose inline helpers.\\n" +\n            "Please use the `extend` helper from @vue/shared instead.",\n        },\n        {\n          selector: "AwaitExpression",\n          message:\n            "Our output target is ES2016, so async/await syntax should be avoided.",\n        },\n        {\n          selector: "ChainExpression",\n          message:\n            "Our output target is ES2016, and optional chaining results in " +\n            "verbose helpers and should be avoided.",\n        },\n      ],\n      "sort-imports": ["error", { ignoreDeclarationSort: true }],\n\n      "import-x/no-nodejs-modules": [\n        "error",\n        { allow: builtinModules.map((mod) => `node:${mod}`) },\n      ],\n      // This rule enforces the preference for using \'@ts-expect-error\' comments in TypeScript\n      // code to indicate intentional type errors, improving code clarity and maintainability.\n      "@typescript-eslint/prefer-ts-expect-error": "error",\n      // Enforce the use of \'import type\' for importing types\n      "@typescript-eslint/consistent-type-imports": [\n        "error",\n        {\n          fixStyle: "inline-type-imports",\n          disallowTypeAnnotations: false,\n        },\n      ],\n      // Enforce the use of top-level import type qualifier when an import only has specifiers with inline type qualifiers\n      "@typescript-eslint/no-import-type-side-effects": "error",\n\n      "import-x/order": [\n        "error",\n        {\n          groups: [\n            "builtin",\n            "external",\n            "internal",\n            "sibling",\n            "parent",\n            "index",\n            "unknown",\n          ],\n          "newlines-between": "always",\n        },\n      ],\n    },\n  },\n\n  // Node scripts\n  {\n    files: ["eslint.config.js", "scripts/**", "packages/*/npm/*.js"],\n    languageOptions: {\n      globals: { ...globals.node },\n    },\n    rules: {\n      "no-restricted-globals": "off",\n      "no-restricted-syntax": ["error", banConstEnum],\n      "no-console": "off",\n    },\n  }\n);\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u914d\u7f6e-prettier",children:"\u914d\u7f6e Prettier"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b89\u88c5 \u4ee3\u7801\u98ce\u683c\u68c0\u67e5 ",(0,i.jsx)(n.code,{children:"prettier"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u5b89\u88c5-prettier",children:"\u5b89\u88c5 prettier"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn add prettier -D -W\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u65b0\u589e-prettierrc",children:"\u65b0\u589e .prettierrc"}),"\n",(0,i.jsxs)(n.p,{children:["\u65b0\u5efa ",(0,i.jsx)(n.code,{children:".prettierrc"})," \u914d\u7f6e\u6587\u4ef6\uff0c\u6dfb\u52a0\u914d\u7f6e\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='.prettierrc'",children:'{\n  "printWidth": 100,\n  "semi": true,\n  "singleQuote": true,\n  "trailingComma": "all",\n  "htmlWhitespaceSensitivity": "strict",\n  "endOfLine": "auto",\n  "quoteProps": "as-needed",\n  "jsxSingleQuote": true,\n  "arrowParens": "avoid"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 ",(0,i.jsx)(n.code,{children:"package.json"})," \u7684 ",(0,i.jsx)(n.code,{children:'"scripts"'})," \u4e2d\u589e\u52a0 ",(0,i.jsx)(n.code,{children:"lint"})," \u5bf9\u5e94\u7684\u6267\u884c\u811a\u672c\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='package.json'",children:'"lint": "eslint --ext .ts,.jsx,.tsx --fix --quiet ./packages"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u914d\u7f6e-typescript",children:"\u914d\u7f6e typescript"}),"\n",(0,i.jsx)(n.h3,{id:"\u5b89\u88c5-typescript",children:"\u5b89\u88c5 typescript"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn  add typescript @types/node -D -W\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u65b0\u589e-tsconfigjson",children:"\u65b0\u589e tsconfig.json"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:"title='tsconfig.json'",children:'{\n  "compilerOptions": {\n    "baseUrl": ".",\n    "rootDir": ".",\n    "target": "esnext",\n    "module": "esnext",\n    "lib": ["dom", "dom.iterable", "esnext"],\n    "moduleResolution": "node",\n    "strict": true,\n    "allowJs": true,\n    "removeComments": true,\n    "skipLibCheck": true,\n    "esModuleInterop": true,\n    "allowSyntheticDefaultImports": true,\n    "forceConsistentCasingInFileNames": true,\n    "noFallthroughCasesInSwitch": true,\n    "resolveJsonModule": true,\n    "isolatedModules": true,\n    "noEmit": true,\n    "types": ["node"],\n    "noImplicitAny": true,\n    "noImplicitThis": true,\n    "strictNullChecks": true,\n    "paths": {\n      "react": ["packages/react"],\n      "shared": ["packages/shared"],\n      "react-reconciler": ["packages/react-reconciler"]\n    }\n  },\n  "include": ["packages/**/*.ts", "packages/**/*.d.ts"],\n  "exclude": ["node_modules"]\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u9009\u62e9\u6253\u5305\u5de5\u5177rollup",children:"\u9009\u62e9\u6253\u5305\u5de5\u5177(rollup)"}),"\n",(0,i.jsxs)(n.p,{children:["\u56e0\u4e3a\u6211\u4eec\u8981\u5f00\u53d1\u7684\u662f\u4e00\u4e2a\u5e93\uff0c\u800c\u4e0d\u662f\u4e1a\u52a1\u4ee3\u7801\u3002\u5e0c\u671b\u5de5\u5177\u5c3d\u53ef\u80fd\u7b80\u6d01\uff0c\u6253\u5305\u4ea7\u7269\u53ef\u8bfb\u6027\u9ad8\uff0c\u6240\u4ee5\u9009\u62e9 ",(0,i.jsx)(n.code,{children:"rollup"}),"\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u5b89\u88c5-rollup",children:"\u5b89\u88c5 rollup"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"yarn add rollup -D -W\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u65b0\u5efa\u6587\u4ef6\u5939 ",(0,i.jsx)(n.code,{children:"scripts/rollup"}),"\uff0c\u7528\u4e8e\u653e\u6240\u6709\u7684\u6253\u5305\u811a\u672c\u3002"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},3881:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(8101);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);